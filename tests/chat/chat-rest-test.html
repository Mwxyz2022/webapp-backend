<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chat REST Test</title>
</head>
<body>
<h2>üì§ Chat REST API Test (/chat/send)</h2>

<p style="background:#f9f9f9; border:1px solid #ccc; padding:10px; margin-bottom:10px;">
    <strong>üîç –©–æ —Ç–µ—Å—Ç—É—î —Ü—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞?</strong><br>
    –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ REST API –¥–æ –±–µ–∫–µ–Ω–¥—É –Ω–∞ <code>/chat/send</code>:
<ul>
    <li>üì§ –í—ñ–¥–ø—Ä–∞–≤–∫–∞ JSON —á–µ—Ä–µ–∑ <code>fetch(..., POST)</code></li>
    <li>üíæ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ MongoDB</li>
    <li>üì¨ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç—Ä–∞–Ω—Å–ª—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ WebSocket</li>
    <li>üöÄ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—É–±–ª—ñ–∫—É—î—Ç—å—Å—è –≤ Kafka (topic <code>chat-outgoing</code>)</li>
</ul>
</p>

<label>Chat ID: <input type="text" id="chatId" value="123456"></label><br>
<label>From (manager): <input type="text" id="from" value="manager-1"></label><br>
<label>To (telegramId): <input type="text" id="to" value="123456789"></label><br>
<label>Text: <input type="text" id="text" value="–ü—Ä–∏–≤—ñ—Ç! –¶–µ REST —Ç–µ—Å—Ç"></label><br><br>

<button onclick="sendMessage()">Send via REST</button>

<pre id="log" style="border:1px solid #ccc; padding:10px; height:200px; overflow-y:scroll;"></pre>

<script>
    function log(message) {
        const logBox = document.getElementById("log");
        logBox.textContent += message + "\n";
        logBox.scrollTop = logBox.scrollHeight;
    }

    async function sendMessage() {
        const payload = {
            chatId: document.getElementById("chatId").value,
            from: document.getElementById("from").value,
            to: document.getElementById("to").value,
            text: document.getElementById("text").value,
            timestamp: null
        };

        try {
            const response = await fetch("http://localhost:1337/http://localhost:8082/chat/send", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            });

            const result = await response.text();
            log("‚úÖ –í—ñ–¥–ø–æ–≤—ñ–¥—å —Å–µ—Ä–≤–µ—Ä–∞: " + result);
        } catch (e) {
            log("‚ùå –ü–æ–º–∏–ª–∫–∞: " + e);
        }
    }
</script>
</body>
</html>
